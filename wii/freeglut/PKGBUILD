_realname=freeglut
pkgname=wii-${_realname}
pkgver=3.6.0
pkgrel=1
pkgdesc='wii freeglut'
arch=('any')
url='https://github.com/freeglut/freeglut/'
license=('BSD')
options=(!strip libtool staticlibs)
makedepends=('catnip')
depends=('libogc' 'wii-opengx')
groups=('wii-portlibs')

source=(
  "${_realname}-${pkgver}.tar.gz::${url}/archive/refs/tags/v${pkgver}-rc1.tar.gz"
  "https://patch-diff.githubusercontent.com/raw/freeglut/freeglut/pull/175.patch"
)

prepare() {
  cd ${_realname}-${pkgver}-rc1/
  patch -Np1 -i ${srcdir}/175.patch
}

build() {
  cd ${_realname}-${pkgver}-rc1/
  catnip -t wii -DFREEGLUT_BUILD_DEMOS=OFF
}

package() {
  cd ${_realname}-${pkgver}-rc1
  DESTDIR=${pkgdir} catnip install
}

sha256sums=('8cf4f4f3ee4d17a348c84c64044280bbf196999f10ac75637f7a5a15e3b8cc04'
            'd26c4d835835b3057137cc566c03c89391b6f6824aaa04b865586f123fc0e170')
